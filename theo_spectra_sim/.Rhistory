library(powerHDX)
files <- list.files(path = "\\results", pattern = "\\.rds$", full.names = TRUE)
sim_results <- do.call("rbind", lapply(files, readRDS))
spectra_by_ph_sequence = split(sim_results, f = sim_results[, c("Sequence", "PH")])
saveRDS(spectra_by_ph_sequence, file = "spectra_by_ph_seq.RDS")
setwd("G:/HDX_sim_vol2/theo_spectra_sim")
files <- list.files(path = "\\results", pattern = "\\.rds$", full.names = TRUE)
files <- list.files(path = "~\results", pattern = "\\.rds$", full.names = TRUE)
files <- list.files(path = "~/results", pattern = "\\.rds$", full.names = TRUE)
setwd("G:/HDX_sim_vol2/theo_spectra_sim")
files <- list.files(path = "G:/HDX_sim_vol2/theo_spectra_sim/results", pattern = "\\.rds$", full.names = TRUE)
setwd("G:/HDX_sim_vol2/theo_spectra_sim")
spectra_by_ph_sequence = readRDS("spectra_by_ph_seq.RDS")
length(spectra_by_ph_sequence)
files <- list.files(path = "G:/HDX_sim_vol2/theo_spectra_sim/results", pattern = "\\.rds$", full.names = TRUE)
files
spectra_by_ph_sequence
library(powerHDX)
a = get_deuteration_curves_from_spectra(spectra_by_ph_sequence)
a = powerHDX::get_deuteration_curves_from_spectra(spectra_by_ph_sequence)
if (!require(devtools)) {
install.packages('devtools')
}
devtools::install_github("hadexversum/powerHDX")
detach("package:powerHDX", unload = TRUE)
if (!require(devtools)) {
install.packages('devtools')
}
devtools::install_github("hadexversum/powerHDX")
library(powerHDX)
remove.packages("powerHDX", lib="~/R/win-library/4.0")
if (!require(devtools)) {
install.packages('devtools')
}
devtools::install_github("hadexversum/powerHDX")
if (!require(devtools)) {
install.packages('devtools')
}
devtools::install_github("hadexversum/powerHDX")
Sys.setenv(R_INSTALL_STAGED = FALSE)
if (!require(devtools)) {
install.packages('devtools')
}
devtools::install_github("hadexversum/powerHDX")
library(powerHDX)
files <- list.files(path = "G:/HDX_sim_vol2/theo_spectra_sim/results", pattern = "\\.rds$", full.names = TRUE)
sim_results <- do.call("rbind", lapply(files, readRDS))
setwd("G:/HDX_sim_vol2/theo_spectra_sim")
files <- list.files(path = "G:/HDX_sim_vol2/theo_spectra_sim/results", pattern = "\\.rds$", full.names = TRUE)
spectra_by_ph_sequence = readRDS("spectra_by_ph_seq.RDS")
files <- list.files(path = "~//results", pattern = "\\.rds$", full.names = TRUE)
files <- list.files(path = ".//results", pattern = "\\.rds$", full.names = TRUE)
files <- list.files(path = "../results", pattern = "\\.rds$", full.names = TRUE)
a = powerHDX::get_deuteration_curves_from_spectra(spectra_by_ph_sequence)
if (!require(devtools)) {
install.packages('devtools')
}
devtools::install_github("hadexversum/powerHDX")
a = powerHDX::get_deuteration_curves_from_spectra(spectra_by_ph_sequence)
a
spectra_by_ph_sequence
setwd("G:/HDX_sim_vol2")
by_ph_sequence = readRDS("by_ph_seq.RDS")
by_ph_sequence
powerHDX::get_deuteration_curves_from_spectra(by_ph_sequence)
spectra_by_ph_sequence[[1]]
if (!require(devtools)) {
install.packages('devtools')
}
devtools::install_github("hadexversum/powerHDX")
if (!require(devtools)) {
install.packages('devtools')
}
devtools::install_github("hadexversum/powerHDX")
if (!require(devtools)) {
install.packages('devtools')
}
devtools::install_github("hadexversum/powerHDX")
if (!require(devtools)) {
install.packages('devtools')
}
devtools::install_github("hadexversum/powerHDX")
library(powerHDX)
a = powerHDX::get_deuteration_curves_from_spectra(by_ph_sequence)
theo_deuteration_curves = lapply(spectra_by_ph_seq, function(spectrum) {
powerHDX::get_deuteration_curve_single_spectrum(spectrum)
})
spectra_by_ph_seq = readRDS("spectra_by_ph_seq.RDS")
setwd("G:/HDX_sim_vol2/theo_spectra_sim")
spectra_by_ph_seq = readRDS("spectra_by_ph_seq.RDS")
theo_deuteration_curves = lapply(spectra_by_ph_seq, function(spectrum) {
powerHDX::get_deuteration_curve_single_spectrum(spectrum)
})
theo_deuteration_curves
files <- list.files(path = "~/results", pattern = "\\.rds$", full.names = TRUE)
files
files <- list.files(path = "/results", pattern = "\\.rds$", full.names = TRUE)
files
files <- list.files(path = "//results", pattern = "\\.rds$", full.names = TRUE)
files
files <- list.files(path = "\\results", pattern = "\\.rds$", full.names = TRUE)
getwd()
files <- list.files(path = "G:/HDX_sim_vol2/theo_spectra_sim/results", pattern = "\\.rds$", full.names = TRUE)
files <- list.files(path = "\\results", pattern = "\\.rds$", full.names = TRUE)
files <- list.files(path = "\\results", pattern = "\\.RDS$", full.names = TRUE)
setwd("G:/HDX_sim_vol2/theo_spectra_sim")
files <- list.files(path = "G:/HDX_sim_vol2/theo_spectra_sim", pattern = "\\.RDS$", full.names = TRUE)
files
files <- list.files(path = "G:/HDX_sim_vol2/theo_spectra_sim/results", pattern = "\\.RDS$", full.names = TRUE)
files <- list.files(path = "/results", pattern = "\\.RDS$", full.names = TRUE)
files <- list.files(path = "G:/HDX_sim_vol2/theo_spectra_sim/results", pattern = "\\.RDS$", full.names = TRUE)
sim_results <- do.call("rbind", lapply(files, readRDS))
spectra_by_ph_sequence = split(sim_results, f = sim_results[, c("Sequence", "PH")])
saveRDS(spectra_by_ph_sequence, file = "spectra_by_ph_seq.RDS")
theo_deut_curves = lapply(spectra_by_ph_seq, function(spectrum) {
get_deuteration_curve_single_spectrum(spectrum)
})
saveRDS(theo_deut_curves, file = "theo_deut_curves.RDS")
theo_deut_curves[[1]]
theo_deut_curves[[1]] %>%
ggplot(aes(x = Exposure, y = Mass, col = PF)) +
geom_line()
library(dplyr)
theo_deut_curves[[1]] %>%
ggplot(aes(x = Exposure, y = Mass, col = PF)) +
geom_line()
library(ggplot2)
theo_deut_curves[[1]] %>%
ggplot(aes(x = Exposure, y = Mass, col = PF)) +
geom_line()
theo_deut_curves[[1]] %>%
ggplot(aes(x = Exposure, y = Mass, col = as.character(PF))) +
geom_line()
all_params_new_pf <- readRDS("G:/HDX_sim_vol2/theo_spectra_sim/all_params_new_pf.RDS")
nrow(all_params_new_pf)
library(powerHDX)
library(dplyr)
library(ggplot2)
files <- list.files(path = "G:/HDX_sim_vol2/theo_spectra_sim/results", pattern = "\\.RDS$", full.names = TRUE)
sim_results <- do.call("rbind", lapply(files, readRDS))
setwd("G:/HDX_sim_vol2/theo_spectra_sim")
params <- readRDS("all_params_new_pfs.RDS")
params <- readRDS("all_params_new_pf.RDS")
params
params <- readRDS("all_params_new_pf.RDS") %>%
select(sequence, pH, charge, protection_factor)
params
nrow(params)
head(sim_results)
params
readRDS("all_params_new_pf.RDS")
head(sim_results)
sim_results %>%
select(Sequence, PH, Charge, PF) %>%
unique()
params
params <- readRDS("all_params_new_pf.RDS") %>%
select(sequence, pH, charge, protection_factor) %>%
unique
params <- readRDS("all_params_new_pf.RDS") %>%
select(sequence, pH, charge, protection_factor) %>%
unique()
params
sim_results %>%
select(Sequence, PH, Charge, PF) %>%
uniqu
sim_results %>%
select(Sequence, PH, Charge, PF)
sim_results %>%
select(Sequence, PH, Charge, PF) %>%
nrow()
sim_results %>%
select(Sequence, PH, Charge, PF) %>%
unique() %>%
nrow()
readRDS("all_params_new_pf.RDS")
sim_results %>%
select(Sequence, PH, Charge, PF) %>%
unique() %>%
nrow()
sim_results %>%
select(Sequence, PH, Charge, PF) %>%
unique()
params <- readRDS("all_params_new_pf.RDS") %>%
select(sequence, pH, protection_factor)
params
params <- readRDS("all_params_new_pf.RDS") %>%
select(sequence, pH, protection_factor) %>%
unique
params <- readRDS("all_params_new_pf.RDS") %>%
select(sequence, pH, protection_factor) %>%
unique()
sim_results %>%
select(Sequence, PH, PF) %>%
unique() %>%
nrow()
params <- readRDS("all_params_new_pf.RDS") %>%
select(sequence, pH, protection_factor) %>%
unique() %>%
unique()
params <- readRDS("all_params_new_pf.RDS") %>%
select(sequence, pH, protection_factor) %>%
unique() %>%
nrow()
readRDS("all_params_new_pf.RDS") %>%
select(sequence, pH, protection_factor) %>%
unique() %>%
nrow()
sim_results %>%
select(Sequence, PH, PF) %>%
unique() %>%
nrow()
?union
sim_results %>%
select(Sequence, PH, PF) %>%
unique() %>%
colnames() = c("sequence", "pH", 'protection_factor')
params <- readRDS("all_params_new_pf.RDS") %>%
select(sequence, pH, protection_factor) %>%
unique()
sim_params <- sim_results %>%
select(Sequence, PH, PF) %>%
unique()
setdiff(params, sim_params)
params <- readRDS("all_params_new_pf.RDS") %>%
select(sequence, pH, protection_factor) %>%
unique()
colnames(params) = c("Sequence", "PH", "PF")
sim_params <- sim_results %>%
select(Sequence, PH, PF) %>%
unique()
setdiff(params, sim_params)
setdiff(params, sim_params) %>%
arrange(desc(Sequence))
library(powerHDX)
library(dplyr)
library(ggplot2)
files <- list.files(path = "G:/HDX_sim_vol2/theo_spectra_sim/results", pattern = "\\.RDS$", full.names = TRUE)
sim_results <- do.call("rbind", lapply(files, readRDS))
a = data.frame()
a
typeof(a)
nrow(a)
sapply(files, function(i) {
dat = readRDS(i)
nrow(dat) == 0
})
sum(sapply(files, function(i) {
dat = readRDS(i)
nrow(dat) == 0
}))
length(files)
params <- readRDS("all_params_new_pf.RDS")
length(params)
params <- readRDS("all_params_new_pf.RDS")
params
length(params)
nrow(params)
nrow(params)
length(files)
nrow(params) - length(files) #missing spectra
files <- list.files(path = "G:/HDX_sim_vol2/theo_spectra_sim/results", pattern = "\\.RDS$", full.names = TRUE)
sim_results <- do.call("rbind", lapply(files, readRDS))
params <- readRDS("all_params_new_pf.RDS")
nrow(params) #all spectra
length(files) #spectra from simulation
nrow(params) - length(files) #missing spectra
missing1 <- sum(sapply(files, function(i) {
dat = readRDS(i)
nrow(dat) == 0
}))
params
readRDS("all_params_new_pf.RDS") %>%
select(sequence, pH, protection_factor, as.numeric(charge))
params <- readRDS("all_params_new_pf.RDS") %>%
select(sequence, pH, charge, protection_factor)
params <- readRDS("all_params_new_pf.RDS")
nrow(params) #all spectra
length(files) #spectra from simulation
nrow(params) - length(files) #missing spectra
missing1 <- sum(sapply(files, function(i) {
dat = readRDS(i)
nrow(dat) == 0
}))
missing1 #empty data frame, i.e. error during simulation
params <- params %>%
select(sequence, pH, charge, protection_factor)
params
sim_results
sim_params <- sim_results %>%
select(Sequence, PH, PF, Charge) %>%
unique() %>%
nrow()
sim_params
sim_results$Charge
sim_results
sim_results %>%
select(Sequence, PH, Charge, PF)
params
colnames(params) = c("Sequence", "PH", "Charge", "PF")
sim_params <- sim_results %>%
select(Sequence, PH, Charge, PF) %>%
unique()
setdiff(params, sim_params) %>%
nrow()
colnames(params) <- c("Sequence", "PH", "Charge", "PF")
params[["Charge"]] <- as.numeric(params[["Charge"]])
sim_params <- sim_results %>%
select(Sequence, PH, Charge, PF) %>%
unique()
setdiff(params, sim_params) %>%
nrow()
params <- params %>%
select(sequence, pH, charge, protection_factor) %>%
unique() %>%
nrow()
params_from_file <- readRDS("all_params_new_pf.RDS")
nrow(params) #all spectra
length(files) #spectra from simulation
nrow(params) - length(files) #missing spectra
missing1 <- sum(sapply(files, function(i) {
dat = readRDS(i)
nrow(dat) == 0
}))
missing1 #empty data frame, i.e. error during simulation
params <- params_from_file %>%
select(sequence, pH, charge, protection_factor) %>%
unique() %>%
nrow()
params_from_file %>%
select(sequence, pH, charge, protection_factor) %>%
unique() %>%
nrow()
length(files)
missing1
nrow(params)
nrow(params_from_file) #all spectra
typeof(params)
typeof(params$Sequence)
library(powerHDX)
library(dplyr)
library(ggplot2)
files <- list.files(path = "G:/HDX_sim_vol2/theo_spectra_sim/results", pattern = "\\.RDS$", full.names = TRUE)
sim_results <- do.call("rbind", lapply(files, readRDS))
params_from_file <- readRDS("all_params_new_pf.RDS")
nrow(params_from_file) #all spectra #12117 rows
length(files) #spectra from simulation #11117 files
nrow(params) - length(files) #missing spectra
missing1 <- sum(sapply(files, function(i) {
dat = readRDS(i)
nrow(dat) == 0
}))
missing1 #empty data frame, i.e. error during simulation #18 data frames
params <- params_from_file %>%
select(sequence, pH, charge, protection_factor) %>%
unique()
colnames(params) <- c("Sequence", "PH", "Charge", "PF")
params[["Charge"]] <- as.numeric(params[["Charge"]])
head()
params <- params_from_file %>%
select(sequence, pH, charge, protection_factor) %>%
unique() %>%
tibble()
params
colnames(params) <- c("Sequence", "PH", "Charge", "PF")
params[["Charge"]] <- as.numeric(params[["Charge"]])
params
sim_params <- sim_results %>%
select(Sequence, PH, Charge, PF) %>%
unique()
sim_params
sim_params
sim_params <- sim_results %>%
select(Sequence, PH, Charge, PF) %>%
unique() %>%
tibble()
sim_params
setdiff(params, sim_params) %>%
nrow()
readRDS(files[1])
params_from_file <- readRDS("all_params_new_pf.RDS")
nrow(params_from_file) #all spectra #12117 rows
length(files) #spectra from simulation #11117 files
nrow(params) - length(files) #missing spectra
missing1 <- sum(sapply(files, function(i) {
dat = readRDS(i)
nrow(dat) == 0
}))
missing1 #empty data frame, i.e. error during simulation #18 data frames
params <- params_from_file %>%
select(sequence, pH, charge, protection_factor) %>%
unique()
colnames(params) <- c("Sequence", "PH", "Charge", "PF")
params[["Charge"]] <- as.numeric(params[["Charge"]])
sim_params <- sim_results %>%
select(Sequence, PH, Charge, PF) %>%
unique()
missing_params <- setdiff(params, sim_params)
missing_params
files
saveRDS(missing_params, file = "missing_params.RDS")
missing_params
head(params)
head(params_from_file)
library(powerHDX)
library(dplyr)
library(ggplot2)
files <- list.files(path = "G:/HDX_sim_vol2/theo_spectra_sim/results", pattern = "\\.RDS$", full.names = TRUE)
sim_results <- do.call("rbind", lapply(files, readRDS))
params_from_file <- readRDS("all_params_new_pf.RDS")
nrow(params_from_file) #all spectra #12117 rows
length(files) #spectra from simulation #11117 files
nrow(params) - length(files) #missing spectra
missing1 <- sum(sapply(files, function(i) {
dat = readRDS(i)
nrow(dat) == 0
}))
missing1 #empty data frame, i.e. error during simulation #18 data frames
params <- params_from_file %>%
select(sequence, pH, charge, protection_factor) %>%
unique()
colnames(params) <- c("Sequence", "PH", "Charge", "PF")
params[["Charge"]] <- as.numeric(params[["Charge"]])
sim_params <- sim_results %>%
select(Sequence, PH, Charge, PF) %>%
unique()
missing_params <- setdiff(params, sim_params)
colnames(missing_params) <- c("sequence", "pH", "charge", "protection_factor")
saveRDS(missing_params, file = "missing_params.RDS")
library(doParallel)
library(powerHDX)
setwd("~/HDX_sim_vol2")
setwd("~/HDX_sim_vol2/theo_spectra_sim")
params_from_file
sort(params_from_file)
sort(params_from_file, order(sequence))
sort(params_from_file, sequence)
